(this.webpackJsonpfront=this.webpackJsonpfront||[]).push([[0],[,,,,,,,,function(e,t,n){e.exports=n(17)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(6),o=n.n(c),i=(n(13),n(2)),u=n(3),s=n(4),l=n.n(s),d=n(7),f=n(1),b=(n(15),function(e){var t=e.code,n=e.send,c=e.gameId,o=e.cursors,i=e.cursorPosition,u=e.setCursorPosition,s=e.wrongChars,l=e.setWrongChars,d=e.color;Object(a.useEffect)((function(){""!==t&&n("cursor",{cursorPosition:i},c)}),[i,c,t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"code-field-header"}),r.a.createElement("pre",{onKeyDown:function(e){var n;e.preventDefault(),n=e.key,["Shift","Meta","Alt","Control","AltGraph"].includes(n)||("Backspace"===e.key?s>0?l(s-1):i>0&&u(i-1):s>0||function(e){if(["Shift","Meta","Alt","Control","Backspace"].includes(e))throw new Error("Not mapable to key");return"Enter"===e?"\n":"Tab"===e?"\t":e}(e.key)!==t[i]?l(s+1):u(i+1))},id:"code-field-body",tabIndex:"0"},t&&t.split("").map((function(e,t){var n={};return Object.entries(o).forEach((function(e){var a=Object(f.a)(e,2),r=a[0],c=a[1];t===c&&d!==r&&(n.background=r)})),s>0?t>=i&&t<i+s&&(n.background="#ba5d5d"):t===i&&(n.background="#cfbaa5"),"\n"===e?r.a.createElement(r.a.Fragment,null,t===i?r.a.createElement("span",{style:n},"\u21b5"):null,r.a.createElement("br",{key:t})):r.a.createElement("span",{key:t,style:n},e)}))))}),m=function(e){var t=e.messages,n=e.onSubmitChatInput,a=e.setChatInput,c=e.chatInput;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"chat-header"}),r.a.createElement("div",{id:"chat-body"},t.map((function(e,t){var n=e.sender,a=e.content;return r.a.createElement("div",{key:t},r.a.createElement("b",null,"<",n,">"),r.a.createElement("span",null,a))}))),r.a.createElement("form",{onSubmit:n,id:"chat-input"},r.a.createElement("input",{onChange:function(e){return a(e.target.value)},type:"text",value:c})))},h=window.location.origin.replace(/^http/,"ws"),p={sender:"liracer",content:'To join a game, send "/join id". If a game by the given id exists you join that, otherwise a new game is created.'},g=function(){var e=Object(a.useState)([]),t=Object(f.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(""),s=Object(f.a)(o,2),g=s[0],j=s[1],v=Object(a.useState)(null),E=Object(f.a)(v,2),O=E[0],w=E[1],y=Object(a.useState)(null),k=Object(f.a)(y,2),S=k[0],C=k[1],I=Object(a.useState)(""),P=Object(f.a)(I,2),W=P[0],x=P[1],B=Object(a.useState)(null),J=Object(f.a)(B,2),T=J[0],A=J[1],D=Object(a.useState)({}),F=Object(f.a)(D,2),M=F[0],N=F[1],q=Object(a.useState)(0),G=Object(f.a)(q,2),K=G[0],Y=G[1],$=Object(a.useState)(0),z=Object(f.a)($,2),H=z[0],L=z[1],Q=function(e,t,n){var a={type:e,body:t,id:n};S.send(JSON.stringify(a))},R=function(e,t){return c((function(n){return n.concat({sender:e,content:t})}))},U=function(){return c((function(e){return e.concat(p)}))};Object(a.useEffect)((function(){R("liracer","Welcome to liracer!"),U(),function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new WebSocket(h),C(t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),Object(a.useEffect)((function(){if(null!==S){S.onmessage=function(e){var t=JSON.parse(e.data),n=t.type,a=t.body;switch(n){case"messages":case"message":c((function(e){return e.concat(a)}));break;case"quote":j(a.code),R("liracer","The current quote is ".concat(a.program," in the ").concat(a.language," language")),Y(0),L(0);break;case"cursor":N((function(e){return Object(u.a)(Object(u.a)({},e),{},Object(i.a)({},a.color,a.cursorPosition))}));break;case"color":w(a.color);break;default:throw new Error("Could not dispatch message")}},S.onerror=function(){return R("liracer","Connection closed. This can probably be resolved by reloading the page.")}}}),[S]);return r.a.createElement("div",{id:"game"},r.a.createElement(m,{messages:n,onSubmitChatInput:function(e){if(e.preventDefault(),""!==W){!function(){var e=W.split(" ");switch(e[0]){case"/join":var t=e[1];Q("join",{},t),A(t),N([]);break;default:if(null===T)R("liracer","You need to be in a game to do this."),U();else Q("message",{content:W},T)}}(),x("")}},chatInput:W,setChatInput:x}),r.a.createElement(b,{code:g,send:Q,gameId:T,cursors:M,cursorPosition:K,setCursorPosition:Y,wrongChars:H,setWrongChars:L,color:O}))},j=(n(16),function(){return r.a.createElement(g,null)});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[8,1,2]]]);
//# sourceMappingURL=main.d8992fa7.chunk.js.map